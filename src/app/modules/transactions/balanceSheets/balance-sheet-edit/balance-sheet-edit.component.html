<div *ngIf="(action$ | async) as action"></div>

<div class="container" *ngIf="(balanceSheet$ | async) as sheet; else loading">
  <mat-card>
    <mat-card-title>
        Balance Sheet
    </mat-card-title>
    <mat-card-subtitle>
      <div *ngIf="sheet.message">
        {{sheet.message }}
      </div>

      <div class="header-grid">
        <div>
          <balance-sheet-header-view
            [sheetType]="sheetType"
            [sheet]    ="sheet">
          </balance-sheet-header-view>
        </div>

        <div>
          <balance-sheet-calculations-view
              [currentBalance]="getCurrentBalance()"
              [sheet]         ="sheet">
          </balance-sheet-calculations-view>
          <balance-sheet-employee-sales
            [id]="sheet.id">
          </balance-sheet-employee-sales>
        </div>

        <div>
          <app-edit-buttons-standard
              (outputeupdateItem)     ="updateItem($event)"
              (outputupdateItemExit)  ="updateItemExit($event)"
              (outputupdatedeleteItem)="deleteItem($event)"
              (outputupdateonCancel)  ="onCancel($event)"
              (outPutPrint)           ="print($event)"
              (outPutEmail)           ="email($event)"
              [emailOption]           ="true"
              [printOption]           ="true"
            ></app-edit-buttons-standard>
        </div>
      </div>

      <mat-divider class="mat-dividers"></mat-divider>

    </mat-card-subtitle>

    <mat-card-content>
      <div *ngIf="sheet" class="grid-container">
        <div>
          <h4><mat-icon>edit</mat-icon> Edit </h4>

          <div *ngIf="!sheet.endTime">
            <span *ngIf ="this.sheet.shiftStarted != 1">
              <button color="warn" mat-raised-button (click)="startShift()">Start Sheet</button>
            </span>
          </div>

          <div *ngIf="!sheet.endTime">
            <span *ngIf ="sheet.shiftStarted == 1 && ordersOpen == 0">
              <button color="warn" mat-raised-button (click)="closeSheet()">Close Sheet</button>
            </span>
            <span *ngIf="ordersOpen>0">
              {{ ordersOpen }} order(s) are open. Close orders to close sheet.
            </span>
          </div>


        </div>
      </div>

      <div  *ngIf="inputForm && sheet"
            class="grid-container"
            [formGroup]="inputForm">

          <div class="header"
              *ngIf="!sheet.shiftStarted || isAuthorized">
              <h4> Start {{ getSummaryOfCashStart() | currency }}
              </h4>
              <div>
                <mat-label>Enter in quantity of currencies.</mat-label>
              </div>
            <div class="grid-container">
              <div >

                 <div>
                  <cash-value-calc
                      [formControlName] = "'dollarsStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "1">
                      Dollars
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] = "'fivesStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "5">
                      Fives
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] = "'tensStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "10">
                      Tens
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] = "'twentiesStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "20">
                      Twenties
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'fiftiesStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "50">
                      Fifites
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] = "'hundredsStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "100">
                      Hundreds
                  </cash-value-calc>
                </div>
              </div>

              <div class="grid-item">

                <div>
                  <cash-value-calc
                      [formControlName] = "'pennyStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".01">
                      Pennies
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                     [formControlName]  = "'nickelStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".05">
                      Nickles
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                       [formControlName]= "'dimeStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".10">
                      Dimes
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] = "'quarterStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".25">
                      Quarters
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                     [formControlName]  = "'halfDollarStart'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".50">
                      Half Dollars
                  </cash-value-calc>
                </div>

              </div>
            </div>
          </div>

          <div class="header"
               *ngIf="sheet.shiftStarted || isAuthorized">
            <h4> End {{ getSummaryOfCashEnd() | currency }} </h4>
            <div>
              <mat-label>Enter in quantity of currencies.</mat-label>
            </div>
            <div class="grid-container">
              <div class="grid-item">

                <div>
                  <cash-value-calc
                      [formControlName] ="'onesEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "1">
                      Ones
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'fivesEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "5">
                      Fives
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                     [formControlName] ="'tensEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "10">
                      Tens
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'twentiesEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "20">
                      Twenties
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'fiftiesEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "50">
                      Fifties
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'hundredsEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = "100">
                      Hundreds
                  </cash-value-calc>
                </div>

              </div>

              <div class="grid-item">
                <div>
                  <cash-value-calc
                      [formControlName] ="'pennyEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".01">
                      Pennies
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'nickelEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".05">
                      Nickels
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'dimeEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".10">
                      Dimes
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'quarterEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".25">
                      Quarters
                  </cash-value-calc>
                </div>

                <div>
                  <cash-value-calc
                      [formControlName] ="'halfDollarEnd'"
                      [inputForm]       = "inputForm"
                      [multiplier]      = ".50">
                      Half Dollars
                  </cash-value-calc>
                </div>

              </div>
            </div>
          </div>
      </div>

    </mat-card-content>
  </mat-card>
</div>

<ng-template #loading >
  <button mat-raised-button (click)="newBalanceSheet()">Start Sheet</button>
  <mat-spinner></mat-spinner>
</ng-template>
