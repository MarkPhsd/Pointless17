<div *ngIf="order">
  <div [class]="orderlayout">
    <div class="transaction-data">

      <div class="grid-header-item">
        <app-payment-balance
          [mainPanel]="true"
          [order]="order">
        </app-payment-balance>
      </div>

      <div class="grid-header-item">
        <app-order-header-demo-graphics
            [canRemoveClient]="'false'"
            [order]          ="order">
        </app-order-header-demo-graphics>
      </div>

      <div class="grid-header-item">
        <posorder-schedule-card>
        </posorder-schedule-card>
      </div>

    </div>

    <div class="results-panel">

      <div class="order-completed" *ngIf="paymentsEqualTotal">
        <mat-card class="card-dimensions">
          <mat-card-content>
            <div *ngIf="order.itemCount == 0 || !order.itemCount">
              <h1>Nothing to see here, place some items in the cart!</h1>
            </div>
            <div *ngIf="order.itemCount>0 ">
              <h1>
                Order paid for and completed!
              </h1>
              <div>
                Thank you for your order. Please review the instructions on your receipt.
              </div>
              <button mat-raised-button color="primary" (click)="closeCart()"><mat-icon>menu</mat-icon> Continue Shopping </button>
            </div>
          </mat-card-content>
        </mat-card>
      </div>

      <div *ngIf="!paymentsEqualTotal && paymentIsReady">
            <div class="grid-header-item" *ngIf="stepSelection == 1">
              <mat-card *ngIf="order.wicTotal !=0 && order.ebtTotal != 0 " >
                <mat-card-content>

                  <span class="item-buttons-container" *ngIf="order.wicTotal && order.wicTotal !=0 ">
                    <button class="payment-buttons" mat-raised-button (click)="applyWICPayment()">
                      <mat-icon color="warn">credit_card</mat-icon>WIC Payment
                    </button>
                  </span>

                  <span class="item-buttons-container" *ngIf="order.ebtTotal && order.ebtTotal !=0 ">
                    <button class="payment-buttons"  mat-raised-button (click)="applyEBTPayment()">
                      <mat-icon color="warn">credit_card</mat-icon>EBT Payment
                    </button>
                  </span>

                </mat-card-content>
              </mat-card>

              <!-- Payment Method Selection -->
              <mat-card class="card-dimensions">
                <mat-card-content class="payment-dimensions">
                  <app-mat-toggle-selector
                      class              = "card-height"
                      [list$]            = "paymentMethods$"
                      [hideAllOption]    = "'true'"
                      [toggleDimensions] = "'toggle-group-tall'"
                      [buttonDimensions] = "'button-dimensions-tall'"
                      (outPutItem)       = "getPaymentMethod($event)"
                    >
                    Select Payment Method
                  </app-mat-toggle-selector>
                </mat-card-content>
              </mat-card>
            </div>

            <div class="grid-header-item" *ngIf="stepSelection == 2">
              <mat-card class="card-dimensions">
                <mat-card-content>
                  <div class="item-container"  *ngIf="paymentMethod">
                    <div>
                      <h4>
                        {{paymentMethod.name}} | Order Balance : {{order.balanceRemaining | currency}}
                      </h4>
                    </div>
                  </div>

                  <div class="item-container item-buttons-container">
                    <span class ="action-buttons">
                      <button mat-button (click)="goToPaymentMethod()" >
                        Start Over
                        <mat-icon>back</mat-icon>
                      </button>
                    </span>
                    <span>
                      <button mat-button
                             (click)="initCheckForm()">Clear <mat-icon>refresh</mat-icon>
                      </button>
                    </span>
                  </div>

                  <div class="item-container keypad">
                    <app-key-pad
                      [inputForm]        ="checkNumberForm"
                      [inputTypeValue]   ="'text'"
                      [showInput]        ="showInput"
                      [alternateClass]   ="'grid-keypad-alternate'"
                      (outPutReturnEnter)="enterCheckNumber($event)">
                      Check #
                  </app-key-pad>
                  </div>
                </mat-card-content>
              </mat-card>
            </div>

            <div class="grid-header-item" *ngIf="stepSelection == 4">
              <mat-card class="card-dimensions">
                <mat-card-content>
                  <div class="item-container"  *ngIf="paymentMethod">
                    <div>
                      <h4>
                        {{paymentMethod.name}} | Order Balance : {{order.balanceRemaining | currency}}
                      </h4>
                      <h5>
                        <div *ngIf="order && order.clients_POSOrders">
                          Point Cash Value {{order.clients_POSOrders.loyaltyPointValue | currency}}
                        </div>
                      </h5>
                    </div>
                  </div>

                  <div class="item-container item-buttons-container">
                    <span class ="action-buttons">
                      <button mat-button (click)="goToPaymentMethod()" >
                        Start Over
                        <mat-icon>back</mat-icon>
                      </button>
                    </span>
                    <span>
                      <button mat-button (click)="initCheckForm()">Clear <mat-icon>refresh</mat-icon></button>
                    </span>
                    <span class ="action-buttons">
                      <button mat-button (click)="applyPointBalance()">
                        Apply Balance
                        <mat-icon>credit_card</mat-icon>
                      </button>
                    </span>
                  </div>

                  <div class="item-container keypad">
                    <app-key-pad
                      [inputForm]        ="pointValueForm"
                      [inputTypeValue]   ="'decimal'"
                      [showInput]        ="showInput"
                      [alternateClass]   ="'grid-keypad-alternate'"
                      (outPutReturnEnter)="enterPointCashValue($event)">
                      Point Amount
                  </app-key-pad>

                  </div>
                </mat-card-content>
              </mat-card>
            </div>

            <div class="grid-header-item" *ngIf="stepSelection == 3">
              <mat-card class="card-dimensions">
                <mat-card-content>
                  <div class="item-container"  *ngIf="paymentMethod">
                    <div>
                      <h4>
                        {{paymentMethod.name}} | Order Balance : {{order.balanceRemaining | currency}}
                        <span *ngIf="paymentMethod.name === 'check'">
                           {{posPayment.checkNumber}}
                        </span>
                      </h4>
                    </div>
                  </div>
                  <div class="item-container  item-buttons-container">
                    <span class ="action-buttons">
                      <button mat-button (click)="goToPaymentMethod()" >
                        Start Over
                        <mat-icon>back</mat-icon>
                      </button>
                    </span>
                    <span class ="action-buttons">
                      <button mat-button (click)="initPaymentForm()">
                        Clear
                        <mat-icon>refresh</mat-icon>
                      </button>
                    </span>
                    <span class ="action-buttons">
                      <button mat-button (click)="applyBalance()">
                        Apply Balance
                        <mat-icon>credit_card</mat-icon>
                      </button>
                    </span>
                  </div>
                  <div class="item-container ">
                    <app-key-pad
                        [inputForm]        ="paymentAmountForm"
                        [inputTypeValue]   ="'decimal'"
                        [showInput]        ="showInput"
                        [alternateClass]   ="'grid-keypad-alternate'"
                        (outPutReturnEnter)="applyPaymentAmount($event)">
                        Enter Payment
                    </app-key-pad>

                  </div>
                </mat-card-content>
              </mat-card>
            </div>

            <div *ngIf="paymentMethod && !platFormService.isApp()">
              <div *ngFor="let item of (paymentMethods$ | async)">
                <div *ngIf="item.id  == paymentMethod.id &&  item.instructions">
                  <h3>{{item.name}}</h3>
                  <mat-hint>
                    <div [innerHTML]="item.instructions" ></div>
                  </mat-hint>
                  <mat-divider></mat-divider>
                </div>
              </div>
            </div>

      </div>


      <div *ngIf="!paymentsEqualTotal && !platFormService.isApp() && !paymentIsReady">
        <div *ngIf="message">
        <mat-icon>alert</mat-icon>{{message}}
        </div>
        <pos-order-schedule
        ></pos-order-schedule>
      </div>

    </div>
  </div>
</div>
