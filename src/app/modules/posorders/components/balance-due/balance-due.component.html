<div *ngIf="(action$ | async) as newOrder"></div>


<div  class="grid-items"
      *ngIf=" (uiTransactions$ | async) as uiTransactions" >
  <div>
    <button class="big-button" mat-raised-button (click)="newDefaultOrder()">New Order</button>
  </div>

  <div class="center-panel">
    <div *ngIf="payment && step == 1">
      <div class="action-center">

        <div class="tip-grid">

          <div class="action-center">
            <h3>
              <div *ngIf="!payment.completionDate && payment">Payment: {{ payment.amountPaid }} </div>
              <div *ngIf="payment.completionDate"> Change Due: {{ changeDue | currency }}</div>
              <!-- <div  class="big-button" *ngIf="finalizer">
                ....printing <mat-icon color="accent">print</mat-icon>
              </div> -->
            </h3>
          </div>
        
          <ng-container [ngTemplateOutlet]="actionCenterView" ></ng-container>

          <div  *ngIf="(payment && payment?.account) || (paymentMethod && paymentMethod?.isCreditCard)">
            <tip-entry-amount
              [payment]            = "payment"
              [paymentMethod]      = "paymentMethod"
              (specifiedTipAmount) = "specifiedTip($event)"
              (outPutTip)          = "customTipAmount($event)"
            ></tip-entry-amount>
          </div>
        </div>
      </div>
    </div>

    <mat-card *ngIf="step == 2">
      <div class="action-center">
        <h2>
          Change Due: {{changeDue | currency}}
        </h2>
      </div>

      <div class="action-center">
        <new-order-type
                  [order]        ="order"
                  [payment]      ="payment"
                  [paymentMethod]="paymentMethod"
                  [showCancel]   ="'false'"
        ></new-order-type>
      </div>

      <mat-card-actions>
          <ng-container [ngTemplateOutlet]="actionCenterView" ></ng-container>
      </mat-card-actions>

    </mat-card>
  </div>

  <div>
    <button class="big-button" mat-raised-button (click)="newDefaultOrder()">New Order</button>
  </div>

</div>

<ng-template #actionCenterView let-stepValue>
  <div class="action-center ">
    <button mat-button
            class="tip-button"
            (click)="printReceipt()">
            <mat-icon>print</mat-icon>
            Print</button>

    <button mat-button
            class="tip-button"
            (click)="close()"><mat-icon>close</mat-icon>
            Exit</button>

    <button mat-button
            class="tip-button"
            (click)="changeStep()">
            <mat-icon>arrow_forward_ios</mat-icon>Next
    </button>
  </div>
</ng-template>
