<div *ngIf="sheets$ | async as sheets; else loading" class="container">

  <mat-card>
    <mat-card-title>
      <h4>Balance Sheets</h4>
    </mat-card-title>
    <mat-card-content>
      <div class="header">
        <div class="grid-item">Start</div>
        <div class="grid-item">ID</div>
        <div class="grid-item">User</div>
        <div class="grid-item">Total</div>
        <div class="grid-item">+/-</div>
        <div class="grid-item">Device</div>
      </div>
      <mat-divider></mat-divider>
      <br>
      <div *ngFor="let item of sheets.results">
        <ng-container
            [ngTemplateOutlet]="reportView"
            [ngTemplateOutletContext]="{$implicit: item}">
        </ng-container>
      </div>

      <div *ngIf="sheets.summary as summary">
        <mat-divider></mat-divider>
        <br>
        <div class="summary">
          <div class="grid-item">Sales Total</div>
          <div class="grid-item">+/-</div>
          <div class="grid-item">In Drawer</div>
        </div>

        <div class="summary">
          <div class="grid-item number-format">{{summary.salesTotal | currency}}</div>
          <div class="grid-item number-format">{{summary.overUnderTotal | currency }}</div>
          <div class="grid-item number-format">{{summary.endedWith | currency }}</div>
        </div>
      </div>

      <mat-card-actions>
        <div *ngIf="sheets.errorMessage">
          <mat-icon color="warn">alert</mat-icon> {{sheets.errorMessage}}
        </div>
      </mat-card-actions>
    </mat-card-content>
  </mat-card>
</div>

<ng-template #reportView let-item>
  <div class="header">
    <div class="grid-item text-format">{{ item.startTime | date: 'M/d/yy' }}</div>
    <div class="grid-item number-format">{{item.id}}</div>
    <div class="grid-item text-format">{{item?.balanceSheetEmployee?.lastName | truncateText : 5}}, {{item?.balanceSheetEmployee?.lastName.slice(0)}}</div>
    <div class="grid-item number-format">{{item.salesTotal | currency}}</div>
    <div class="grid-item number-format">{{item.overUnderTotal | currency }}</div>
    <div></div>
    <div></div>
    <div class="grid-item text-format">{{item.deviceName  }}</div>
  </div>

</ng-template>

<ng-template #loading>
  ...loading balance sheets
  <mat-spinner [diameter]="25"></mat-spinner>
</ng-template>
<!--
type:              number;
dateTime:          string;
noSales:           number;
startTime:         string;
deviceName:        string;
employeeID:        number;
salesTotal:        number;
overUnderTotal:    number;
registerPosVoids:  number;
registerNegVoids:  number;
startedWith:       number;
endedWith:         number;
endTime:           string;
cashIn:            number;
creditIn:          number;
cashDropCheck:     number;
reportRunMasterID: number;
creditTips:        number;
paidOuts:          number;
mileage:           number;
storeID:           string;
cashDeposit:       number;
checkDeposit:      number;
otherDeposit:      number;
depositer:         string;
cashDropAmount:    number;
reportName:        string;
balanceSheetEmployee  : BalanceSheetEmployee; -->
