

<div *ngIf=" (sales$ | async) as sales; else loading">

  <div *ngIf="sales.resultMessage != 'success'">
    {{sales.resultMessage}}
  </div>

  <div *ngIf="sales.paymentSummary as payments">

    <div
          class="mat-card-container"
          *ngIf="sales.resultMessage != 'failed'">
      <mat-card  *ngIf="payments">
        <mat-card-title>

          <div class="center-container">
            <div class="grid spacer footerheader-margin">
              <div  class="header-label">
                <h4> <ng-content></ng-content> </h4>
              </div>
            </div>
          </div>

          <div class="grid spacer">
            <div class="header-labels">
              {{sales.paymentSummary[0].startDate | date: 'short'}}
            </div>
            <div  class="header-labels">
              {{sales.paymentSummary[0].endDate | date: 'short'}}
            </div>
          </div>

        </mat-card-title>

        <mat-card-content>
          <div class="grid-headerfooter headers totals" *ngIf="payments">
            <span *ngIf="groupBy === 'Employee'">
              <div>Staff</div>
            </span>

            <span *ngIf="groupBy === 'PaymentMethod'">
              <div>Method</div>
            </span>

            <div>Avg</div>
            <div>Amount</div>
            <div>Tip</div>
            <div>#</div>
          </div>

          <div class="grid-items"
              *ngFor="let payment of payments" >

            <span *ngIf="groupBy === 'Employee'">
              <div class="totals"
                  *ngIf="payment.employeeName">
                {{ payment.employeeName | truncateText: 10 }}
              </div>
              <div class="totals"
                  *ngIf="!payment.employeeName">
                Missing
              </div>
            </span>

            <span *ngIf="groupBy === 'PaymentMethod'">
              <div class="totals"
                  *ngIf="payment.paymentMethod">
                {{ payment.paymentMethod }}
              </div>
            </span>

            <div class="totals" *ngIf=" payment.count != 0">
              {{payment.amountPaid / payment.count | currency }}
            </div>

            <div class="totals">
              {{payment.amountPaid | currency }}
            </div>

            <div class="totals"
                >
              {{payment.tipAmount | currency }}
            </div>

            <div class="totals" *ngIf="payment?.count != 0">
              {{payment.count }}
            </div>
          </div>
        </mat-card-content>

        <mat-card-footer>
          <div class="footerheader-margin">

            <div  class="grid-footer footerheader-margin">
              <div>Average</div>
              <div class="totals" *ngIf=" sales.count != 0">
                {{sales.total / sales.count | currency }}
              </div>
            </div>

            <div  class="grid-footer footerheader-margin"   >
              <div>Total</div>
              <div class="totals">
                {{sales.total | currency }}
              </div>
            </div>

            <div  class="grid-footer footerheader-margin"   >
              <div>Count</div>
              <div class="totals">
                {{sales.count }}
              </div>
            </div>
          </div>

        </mat-card-footer>
      </mat-card>
    </div>

  </div>

</div>


<ng-template #loading>
  <mat-spinner [diameter]="25" class="spinner"></mat-spinner>
</ng-template>
<!--
this.sales = data.paymentSummary;
this.message = data.resultMessage -->
