

<div *ngIf=" (sales$ | async) as sales; else loading">

  <div *ngIf="sales.resultMessage != 'success'">
    {{sales.resultMessage}}
  </div>

  <div *ngIf="sales.paymentSummary as payments">
    <div  class="mat-card-container"
          *ngIf="sales.resultMessage != 'failed'">
      <mat-card  *ngIf="payments">
        <mat-card-title>
          <div class="grid">
            <div  class="totals_label">
              <h4> <ng-content></ng-content> </h4>
            </div>
          </div>

          <div class="grid">
            <div class="header-labels">
              {{sales.paymentSummary[0].startDate | date: 'short'}}
            </div>
            <div  class="header-labels">
              {{sales.paymentSummary[0].endDate | date: 'short'}}
            </div>
          </div>

        </mat-card-title>

        <mat-card-content>
          <div class="grid-headerfooter"
               *ngIf="payments">

            <div *ngIf="groupBy === 'Employee'" class="grid-item">Staff </div>
            <div *ngIf="groupBy !=  'Employee'" class="grid-item">Method</div>

            <div class="totals">Amount</div>
            <div class="totals">Avg</div>
            <div class="totals">Tip</div>

            <div *ngIf="groupBy === 'Employee'" class="grid-item">    </div>
            <div *ngIf="groupBy !=  'Employee'" class="grid-item">    </div>
          </div>

          <div class="grid-headerfooter"
               *ngFor="let payment of payments" >

            <span *ngIf="groupBy === 'Employee'">
              <div class="employeeName"
                  *ngIf="payment.employeeName">
                {{ payment.employeeName | truncateText: 10 }}
              </div>
              <div class="employeeName"
                  *ngIf="!payment.employeeName">
                Missing
              </div>
            </span>

            <div class="grid-item" *ngIf="groupBy != 'Employee'" >
              {{ payment.paymentMethod }}
            </div>

            <div  class="totals">
              {{payment.amountPaid | currency }}
            </div>

            <div  class="totals" *ngIf=" payment.count != 0">
              {{payment.amountPaid / payment.count | currency }}
            </div>

            <div class="totals calculation">
              {{payment.tipAmount | currency }}
            </div>

            <div  class="grid-item calculation" *ngIf="payment?.count != 0">
              {{ payment.count }}
            </div>

          </div>
          <mat-divider></mat-divider>
        </mat-card-content>

        <mat-card-footer>

          <div class="grid-footer">
            <div class="totals">
              Credit Total
            </div>
            <div class="totals ">
              {{sales.creditTotal | currency }}
            </div>
            <div class="totals" >
            </div>
            <div class="totals">
            </div>
          </div>

          <div class="grid-footer"
               *ngIf="payments">
            <div class="grid-item">-----</div>
            <div class="totals">Total</div>
            <div class="totals">Avg</div>
            <div class="totals">Count</div>
          </div>



          <div class="grid-footer">
            <div class="grid-item ">
              Total
            </div>
            <div class="totals">
              {{sales.total | currency }}
            </div>
            <div class="totals" *ngIf=" sales.count != 0">
              {{sales.total / sales.count | currency }}
            </div>
            <div class="totals">
              {{sales.count }}
            </div>
          </div>


        </mat-card-footer>
      </mat-card>
    </div>

  </div>

</div>

<ng-template #loading>
  <mat-spinner [diameter]="25" class="spinner"></mat-spinner>
</ng-template>
<!--
this.sales = data.paymentSummary;
this.message = data.resultMessage -->
