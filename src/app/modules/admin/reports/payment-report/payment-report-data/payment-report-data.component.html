

<div *ngIf="printAction$ | async"></div>

<div #printsection class="printFont-14">
  <div class="mat-card-container"
        *ngIf="sales.resultMessage != 'success'">
    <mat-card>
      <h4><ng-content></ng-content> </h4>

      <div>
        {{sales.resultMessage}}  {{groupBy}}
      </div>

      <div>
        There are no {{type}}.
      </div>
    </mat-card>
  </div>


  <div *ngIf="sales.paymentSummary as payments">
    <div  class="mat-card-container"
          *ngIf="sales.resultMessage != 'failed'">

    <div  *ngIf="payments && autoPrint">
      <ng-container [ngTemplateOutlet]="headerView"></ng-container>
      <ng-container [ngTemplateOutlet]="contentView"></ng-container>
      <ng-container [ngTemplateOutlet]="footerView"></ng-container>
    </div>

    <mat-card  *ngIf="payments && !autoPrint">
      <mat-card-title>
        <h4> <ng-container [ngTemplateOutlet]="headerView"></ng-container> </h4>
      </mat-card-title>
      <mat-card-content>
        <ng-container [ngTemplateOutlet]="contentView"></ng-container>
        <mat-divider></mat-divider>
      </mat-card-content>
      <mat-card-footer>
        <ng-container [ngTemplateOutlet]="footerView"></ng-container>
      </mat-card-footer>
    </mat-card>

    <ng-template #headerView>
        <div  class="grid">
          <div>
            <h4> <ng-content></ng-content> </h4>
          </div>
          <div  class="grid-buttons">
            <div>
              <button mat-raised (click)="downloadCSV()">
              <mat-icon>download</mat-icon></button>
            </div>
            <div>
              <button mat-raised (click)="dataGridView()">
              <mat-icon>open_in_full</mat-icon></button>
            </div>
            <div>
              <button mat-raised (click)="print()">
              <mat-icon>print</mat-icon></button>
            </div>
          </div>
        </div>

        <div class="grid">
          <div class="header-labels">
            {{sales.paymentSummary[0].startDate | date: 'short'}}
          </div>
          <div  class="header-labels">
            {{sales.paymentSummary[0].endDate | date: 'short'}}
          </div>
        </div>
      </ng-template>

      <ng-template #contentView>
        <div  class="grid-payment-report-card-header printFont-14"
            *ngIf="payments && groupBy && (groupBy.toLowerCase() === 'devicename' ||
                                groupBy.toLowerCase() === 'paymentMethod'.toLowerCase() ||
                                groupBy.toLowerCase() === 'employee'.toLowerCase())">

            <div *ngIf="groupBy.toLowerCase()  === 'employee'" class="grid-item">Staff </div>
            <div *ngIf="groupBy.toLowerCase()  === 'employee'" class="totals">Amount</div>
            <div *ngIf="groupBy.toLowerCase()  === 'employee'" class="totals">Avg</div>
            <div *ngIf="groupBy.toLowerCase()  === 'employee'" class="totals">#</div>
            <div *ngIf="groupBy.toLowerCase()  === 'employee'" class="totals">Tip</div>

            <div *ngIf="groupBy === 'paymentMethod'" class="grid-item">Method</div>
            <div *ngIf="groupBy === 'paymentMethod'" class="totals">Amount</div>
            <div *ngIf="groupBy === 'paymentMethod'" class="totals">Avg</div>
            <div *ngIf="groupBy === 'paymentMethod'" class="totals">#</div>
            <div *ngIf="groupBy === 'paymentMethod'" class="totals">Tip</div>
          </div>

          <div  class="grid-payment-report-card-header"
            *ngIf="payments && groupBy && groupBy === 'orderemployeecount'">
            <div class="grid-item">Staff</div>
            <div class="grid-item">Hour</div>
            <div class="grid-item">#</div>
            <div class="grid-item">Total</div>
            <div class="grid-item">Avg</div>
          </div>

          <div  class="grid-payment-report-card-header"
            *ngIf="payments && groupBy && groupBy === 'service'">
            <div *ngIf="groupBy === 'service'" class="grid-item">Method</div>
            <div *ngIf="groupBy === 'service'" class="totals">Amount</div>
            <div *ngIf="groupBy === 'service'" class="totals">Avg</div>
            <div *ngIf="groupBy === 'service'" class="totals">#</div>
            <div *ngIf="groupBy === 'service'" class="totals">Tip</div>
          </div>

          <div  class="grid-payment-report-card-header"
            *ngIf="payments && !groupBy">
            <div class="totals">Method</div>
            <div class="totals">Reason</div>
            <div class="totals">Employee</div>
            <div class="totals">Order</div>
            <div class="totals">Amount </div>
          </div>

          <div  class="grid-payment-report-card-header"
                *ngIf="payments && groupBy === 'devicename'">
            <div class="totals">POS</div>
            <div class="totals">Amount</div>
            <div class="totals">AVG</div>
            <div class="totals">#</div>
            <div class="totals">TIP </div>
          </div>

          <div class="mat-divider"></div>

          <app-payment-report-card
            [payments] ="payments"
            [type]     ="type"
            [groupBy]  ="groupBy">
          </app-payment-report-card>

      </ng-template>

      <ng-template #footerView>

        <div class="grid-footer-payments" *ngIf="groupBy && (groupBy === 'paymentMethod')">
          <div>---</div>
          <div class="grid-items" style="width: 175px;margin-top:10px">
            Credit Total
          </div>
          <div class="totals"  style="margin-top:10px">
            {{sales.creditTotal | currency }}
          </div>
        </div>

        <div class="grid-footer-payments" *ngIf="groupBy && (groupBy === 'service')">

          <!-- <div class="grid-items">
            Total
          </div>
          <div>---</div>
          <div class="totals">
            {{sales.creditTotal | currency }}
          </div> -->
        </div>

        <div class="grid-footer-payments"   *ngIf="payments">
          <div class="grid-item">-----</div>
          <div class="totals">Total</div>
          <div class="totals">Avg</div>
          <div class="totals">#</div>
        </div>

        <div class="grid-footer-payments">
          <div class="grid-item">
            Total
          </div>
          <div class="totals">
            {{sales.total | currency }}
          </div>
          <div class="totals" *ngIf=" sales.count != 0">
            {{sales.total / sales.count | currency }}
          </div>
          <div class="totals">
            {{sales.count }}
          </div>
        </div>
      </ng-template>

    </div>
  </div>

</div>
