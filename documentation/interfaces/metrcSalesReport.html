<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>pointless documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top d-block d-sm-none">
            <a href="../" class="navbar-brand">pointless documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">













<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  metrcSalesReport</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/modules/admin/metrc/pointless-metrcsales/pointless-metrcsales.component.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#CityTax" 
>
                                            CityTax
                                        </a>
                                </li>
                                <li>
                                        <a href="#clientType" 
>
                                            clientType
                                        </a>
                                </li>
                                <li>
                                        <a href="#completeDate" 
>
                                            completeDate
                                        </a>
                                </li>
                                <li>
                                        <a href="#CountyTax" 
>
                                            CountyTax
                                        </a>
                                </li>
                                <li>
                                        <a href="#DiscountAmount" 
>
                                            DiscountAmount
                                        </a>
                                </li>
                                <li>
                                        <a href="#ExciseTax" 
>
                                            ExciseTax
                                        </a>
                                </li>
                                <li>
                                        <a href="#idMethod" 
>
                                            idMethod
                                        </a>
                                </li>
                                <li>
                                        <a href="#MunicipalTax" 
>
                                            MunicipalTax
                                        </a>
                                </li>
                                <li>
                                        <a href="#netTotal" 
>
                                            netTotal
                                        </a>
                                </li>
                                <li>
                                        <a href="#oomp" 
>
                                            oomp
                                        </a>
                                </li>
                                <li>
                                        <a href="#oompb" 
>
                                            oompb
                                        </a>
                                </li>
                                <li>
                                        <a href="#orderID" 
>
                                            orderID
                                        </a>
                                </li>
                                <li>
                                        <a href="#packageLabel" 
>
                                            packageLabel
                                        </a>
                                </li>
                                <li>
                                        <a href="#Price" 
>
                                            Price
                                        </a>
                                </li>
                                <li>
                                        <a href="#quantityTotal" 
>
                                            quantityTotal
                                        </a>
                                </li>
                                <li>
                                        <a href="#SalesTax" 
>
                                            SalesTax
                                        </a>
                                </li>
                                <li>
                                        <a href="#SubTotal" 
>
                                            SubTotal
                                        </a>
                                </li>
                                <li>
                                        <a href="#UnitWeight" 
>
                                            UnitWeight
                                        </a>
                                </li>
                                <li>
                                        <a href="#uom" 
>
                                            uom
                                        </a>
                                </li>
                                <li>
                                        <a href="#UTHC" 
>
                                            UTHC
                                        </a>
                                </li>
                                <li>
                                        <a href="#UTHCC" 
>
                                            UTHCC
                                        </a>
                                </li>
                                <li>
                                        <a href="#UTHCUOM" 
>
                                            UTHCUOM
                                        </a>
                                </li>
                                <li>
                                        <a href="#UWUOM" 
>
                                            UWUOM
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="CityTax"></a>
                                        <span class="name "><b>CityTax</b>
                                            <a href="#CityTax">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>CityTax:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="clientType"></a>
                                        <span class="name "><b>clientType</b>
                                            <a href="#clientType">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>clientType:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="completeDate"></a>
                                        <span class="name "><b>completeDate</b>
                                            <a href="#completeDate">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>completeDate:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="CountyTax"></a>
                                        <span class="name "><b>CountyTax</b>
                                            <a href="#CountyTax">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>CountyTax:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="DiscountAmount"></a>
                                        <span class="name "><b>DiscountAmount</b>
                                            <a href="#DiscountAmount">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>DiscountAmount:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="ExciseTax"></a>
                                        <span class="name "><b>ExciseTax</b>
                                            <a href="#ExciseTax">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>ExciseTax:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="idMethod"></a>
                                        <span class="name "><b>idMethod</b>
                                            <a href="#idMethod">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>idMethod:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="MunicipalTax"></a>
                                        <span class="name "><b>MunicipalTax</b>
                                            <a href="#MunicipalTax">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>MunicipalTax:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="netTotal"></a>
                                        <span class="name "><b>netTotal</b>
                                            <a href="#netTotal">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>netTotal:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="oomp"></a>
                                        <span class="name "><b>oomp</b>
                                            <a href="#oomp">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>oomp:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="oompb"></a>
                                        <span class="name "><b>oompb</b>
                                            <a href="#oompb">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>oompb:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="orderID"></a>
                                        <span class="name "><b>orderID</b>
                                            <a href="#orderID">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>orderID:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="packageLabel"></a>
                                        <span class="name "><b>packageLabel</b>
                                            <a href="#packageLabel">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>packageLabel:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="Price"></a>
                                        <span class="name "><b>Price</b>
                                            <a href="#Price">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>Price:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="quantityTotal"></a>
                                        <span class="name "><b>quantityTotal</b>
                                            <a href="#quantityTotal">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>quantityTotal:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="SalesTax"></a>
                                        <span class="name "><b>SalesTax</b>
                                            <a href="#SalesTax">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>SalesTax:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="SubTotal"></a>
                                        <span class="name "><b>SubTotal</b>
                                            <a href="#SubTotal">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>SubTotal:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="UnitWeight"></a>
                                        <span class="name "><b>UnitWeight</b>
                                            <a href="#UnitWeight">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>UnitWeight:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="uom"></a>
                                        <span class="name "><b>uom</b>
                                            <a href="#uom">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>uom:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="UTHC"></a>
                                        <span class="name "><b>UTHC</b>
                                            <a href="#UTHC">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>UTHC:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="UTHCC"></a>
                                        <span class="name "><b>UTHCC</b>
                                            <a href="#UTHCC">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>UTHCC:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="UTHCUOM"></a>
                                        <span class="name "><b>UTHCUOM</b>
                                            <a href="#UTHCUOM">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>UTHCUOM:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="UWUOM"></a>
                                        <span class="name "><b>UWUOM</b>
                                            <a href="#UWUOM">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>UWUOM:         <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../miscellaneous/variables.html#s" target="_self" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { DatePipe } from &#x27;@angular/common&#x27;;
import { Component, HostListener, Input, OnDestroy, OnInit, ViewChild } from &#x27;@angular/core&#x27;;
// import { GridAlignColumnsDirective } from &#x27;@angular/flex-layout/grid/typings/align-columns/align-columns&#x27;;

import {  IPOSOrder, ISite } from &#x27;src/app/_interfaces&#x27;;
import { OrdersService, ReportingService } from &#x27;src/app/_services&#x27;;
import { SitesService } from &#x27;src/app/_services/reporting/sites.service&#x27;;

import { Capacitor, Plugins } from &#x27;@capacitor/core&#x27;;
import { METRCSalesReportPaged, PointlessMetrcSales, PointlessMETRCSalesService, PointlessMetrcSearchModel } from &#x27;src/app/_services/metrc/pointless-metrcsales.service&#x27;;
import { UntypedFormBuilder, UntypedFormControl, UntypedFormGroup } from &#x27;@angular/forms&#x27;;
import { IItemBasic } from &#x27;src/app/_services/menu/menu.service&#x27;;
import { debounceTime, distinctUntilChanged, switchMap,filter,tap } from &#x27;rxjs/operators&#x27;;
import { Observable, Subject ,fromEvent, Subscription, of } from &#x27;rxjs&#x27;;
import { AgGridFormatingService } from &#x27;src/app/_components/_aggrid/ag-grid-formating.service&#x27;;
// import { GridAlignColumnsDirective } from &#x27;@angular/flex-layout/grid/typings/align-columns/align-columns&#x27;;
import { IGetRowsParams,  GridApi } from &#x27;ag-grid-community&#x27;;
// import &quot;ag-grid-community/dist/styles/ag-grid.css&quot;;
// import &quot;ag-grid-community/dist/styles/ag-theme-alpine.css&quot;;
import { ButtonRendererComponent } from &#x27;src/app/_components/btn-renderer.component&#x27;;
import { AgGridService } from &#x27;src/app/_services/system/ag-grid-service&#x27;;
// import &#x27;ag-grid-community/dist/styles/ag-theme-material.css&#x27;;
import { UserAuthorizationService } from &#x27;src/app/_services/system/user-authorization.service&#x27;;
import { IPagedList } from &#x27;src/app/_services/system/paging.service&#x27;;
import { ReportingItemsSalesService } from &#x27;src/app/_services/reporting/reporting-items-sales.service&#x27;;
import { UnparseConfig } from &#x27;ngx-papaparse&#x27;;
import { OrderMethodsService } from &#x27;src/app/_services/transactions/order-methods.service&#x27;;
import { DateHelperService } from &#x27;src/app/_services/reporting/date-helper.service&#x27;;

// const fields &#x3D; [&#x27;completeDate&#x27;,&#x27;clientType&#x27;, &#x27;oomp&#x27;,  &#x27;oompb&#x27;, &#x27;value&#x27;, &#x27;packageLabel&#x27;,&#x27;quantityTotal&#x27;,&#x27;unitType&#x27;,  &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, &#x27;netTotal&#x27;,&#x27;orderID&#x27;,
//         , &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, , &#x27;value&#x27;, &#x27;value&#x27; , &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27; ]

export interface metrcSalesReport {
  completeDate: string;
  clientType: string;
  oomp: string;
  oompb: string;
  idMethod: string;
  packageLabel: string;
  quantityTotal: string;
  uom: string;
  UTHC: string;
  UTHCC: string;
  UTHCUOM: string;
  UnitWeight: string;
  UWUOM: string;
  netTotal: string;
  orderID: string;
  Price: string;
  ExciseTax: string;
  CityTax: string;
  CountyTax: string;
  MunicipalTax: string;
  DiscountAmount: string;
  SubTotal: string;
  SalesTax: string;
}

@Component({
  selector: &#x27;app-pointless-metrcsales&#x27;,
  templateUrl: &#x27;./pointless-metrcsales.component.html&#x27;,
  styleUrls: [&#x27;./pointless-metrcsales.component.scss&#x27;]
})
export class PointlessMETRCSalesComponent implements OnInit , OnDestroy{

  @ViewChild(&#x27;agGrid2&#x27;)      agGrid2: any;
  get platForm()         {  return Capacitor.getPlatform(); }
  get PaginationPageSize(): number {return this.pageSize;  }
  get gridAPI(): GridApi {  return this.gridApi;  }

  dateFrom: string;
  dateTo: string;
  selectedSiteID:        number;
  site$: Observable&lt;ISite&gt;;
  sites$: Observable&lt;ISite[]&gt;;
  site: ISite;
  currentDayRan: boolean;
   //AgGrid
   params               : any;
   private gridApi      : GridApi;
   // private gridColumnApi: GridAlignColumnsDirective;
   gridOptions          : any
   columnDefs           &#x3D; [];
   defaultColDef        ;
   frameworkComponents  : any;
   rowSelection         : any;
   rowDataClicked1      &#x3D; {};
   rowDataClicked2      &#x3D; {};
   rowData:             any[];
   pageSize                &#x3D; 20
   currentRow              &#x3D; 1;
   currentPage             &#x3D; 1
   numberOfPages           &#x3D; 1
   startRow                &#x3D; 0;
   endRow                  &#x3D; 0;
   recordCount             &#x3D; 0;
   isfirstpage             &#x3D; true;
   islastpage              &#x3D; true;

   exceptionMessage: string;
   value             : any;
   totalRecordCount: number;
   searchForm      : UntypedFormGroup;
   inputForm       : UntypedFormGroup;
   dateRange       : UntypedFormGroup;
   selected        : any[];
   selectedRows    : any;
   agtheme         &#x3D; &#x27;ag-theme-material&#x27;;
   gridDimensions  &#x3D; &quot;width: 100%; height: calc(85vh -200px);&quot;
   filterDimensions &#x3D; &#x27;height: calc(100vh - 200px)&#x27;
   urlPath:        string;
   processing      : boolean;
   id              : number;
   employees$      : Observable&lt;IItemBasic[]&gt;;
   buttonName       &#x3D; &#x27;View&#x27;
   searchModel:  PointlessMetrcSearchModel
   _searchModel    :   Subscription;
   isAuthorized    :   boolean;
   smallDevice     &#x3D; false;
   exceptions      :PointlessMetrcSales[]
   searchPhrase:   Subject&lt;any&gt; &#x3D; new Subject();
   order$:  Observable&lt;IPOSOrder&gt;;

   searchItems$              : Subject&lt;PointlessMetrcSearchModel&gt; &#x3D; new Subject();
   _searchItems$ &#x3D; this.searchPhrase.pipe(
     debounceTime(250),
       distinctUntilChanged(),
       switchMap(searchPhrase &#x3D;&gt;
         this.refreshSearch()
     )
   )

   clearExceptions(event) { this.exceptions &#x3D; [] }

   initSubscriptions() {
    try {
      this._searchModel &#x3D; this.pointlessMetrcSalesReport.searchModel$.subscribe( data &#x3D;&gt; {
        this.currentDayRan &#x3D; false;
        if (!data) {
          this.exceptions &#x3D; []
        }
          this.searchModel            &#x3D; data
          if (!this.searchModel) {
            const searchModel       &#x3D; {} as PointlessMetrcSearchModel;
            this.currentPage        &#x3D; 1
            searchModel.pageNumber  &#x3D; 1;
            searchModel.pageSize    &#x3D; 20;
            this.searchModel        &#x3D; searchModel;
            return;
          }

          if (data) {
            if (!this.searchModel.currentDay) {
              this.gridOptions &#x3D; this.agGridFormatingService.initGridOptions(1000000, this.columnDefs);
            }
            this.refreshSearch_sub()
          }
        }
      )
    } catch (error) {
      console.log(&#x27;init subscription error&#x27;, error)
    }
   }

  constructor(
    private readonly datePipe: DatePipe,
    private agGridService: AgGridService,
    private userAuthorization       : UserAuthorizationService,
    private fb                      : UntypedFormBuilder,
    private siteService: SitesService,
    private agGridFormatingService  : AgGridFormatingService,
    private reportingServices: ReportingService,
    public orderMethodsService: OrderMethodsService,
    private orderService: OrdersService,
    private dateHelperService: DateHelperService,
    private pointlessMetrcSalesReport: PointlessMETRCSalesService,
    private reportingItemsSalesService: ReportingItemsSalesService,
    ) {
    this.initSubscriptions();
    this.initForm();
    this.initColumnDefs(10000);
  }

  ngOnInit(): void {
    this.site &#x3D; {} as ISite;
    this.sites$ &#x3D; this.siteService.getSites();
    this.site &#x3D; this.siteService.getAssignedSite()
    this.initClasses();
    this.updateResize()
  }

  ngOnDestroy(): void {
    //Called once, before the instance is destroyed.
    //Add &#x27;implements OnDestroy&#x27; to the class.
    if (this._searchModel) { this._searchModel.unsubscribe()}
    this.exceptions &#x3D; null;
  }

  initForm() {
    this.searchForm &#x3D; this.fb.group({
      itemName : [&#x27;&#x27;]
    })
    this.dateRange &#x3D; new UntypedFormGroup({
      startDate: new UntypedFormControl(),
      endDate: new UntypedFormControl()
    });
  }

  @HostListener(&quot;window:resize&quot;, [])
  updateResize() {
    this.smallDevice &#x3D; false
    if (window.innerWidth &lt; 768) {
      this.smallDevice &#x3D; true
      this.gridDimensions &#x3D; &#x27;width: 100%; height: calc(100vh - 200px);&#x27;
    }
    this.filterDimensions &#x3D; &#x27;height: calc(100vh - 200px)&#x27;
    this.gridDimensions &#x3D;  &#x27;width: 100%;  height: calc(100vh - 200px);&#x27;
    if (this.exceptions &amp;&amp; this.exceptions.length&gt;0) {
      this.gridDimensions &#x3D;  &#x27;width: 100%;  height: calc(100vh - 350px);&#x27;
      this.filterDimensions &#x3D; &#x27;height: calc(100vh - 350px)&#x27;
    }
  }

  initClasses()  {
    const platForm &#x3D; this.platForm;
    this.gridDimensions &#x3D;  &#x27;width: 100%;  height: calc(100vh - 200px);&#x27;
    this.agtheme  &#x3D; &#x27;ag-theme-material&#x27;;
    if (platForm &#x3D;&#x3D;&#x3D; &#x27;capacitor&#x27;) { this.gridDimensions &#x3D;  &#x27;width: 100%;  height: calc(100vh - 200px);&#x27;}
    if (platForm &#x3D;&#x3D;&#x3D; &#x27;electron&#x27;)  { this.gridDimensions &#x3D; &#x27;width: 100%;  height: calc(100vh - 200px);&#x27;}
  }

  initColumnDefs(pageSize: number) {
    this.frameworkComponents &#x3D; {
      btnCellRenderer: ButtonRendererComponent
    };
    this.defaultColDef &#x3D; {
      flex: 1,
      minWidth: 100
    };
    this.columnDefs &#x3D;  [
      {
        field: &#x27;orderID&#x27;,
        cellRenderer: &quot;btnCellRenderer&quot;,
                      cellRendererParams: {
                        onClick: this.editProductFromGrid.bind(this),
                        label: this.getLabel.bind(this),
                        getLabelFunction: this.getLabel.bind(this),
                        btnClass: &#x27;btn btn-primary btn-sm&#x27;
                      },
                      minWidth: 125,
                      maxWidth: 125,
                      flex: 2,
      },
      {headerName: &#x27;Sale Date&#x27;,  sortable: true,
                    field: &#x27;completeDate&#x27;,
        width:    155,
        minWidth: 155,
        maxWidth: 225,
        flex: 2,
        valueFormatter: ({ value }) &#x3D;&gt; this.datePipe.transform(value, &#x27;short&#x27;)
      },

      {headerName: &#x27;Client Type&#x27;, field: &#x27;clientType&#x27;, sortable: true,
        width:    155,
        minWidth: 155,
        maxWidth: 225,
        flex: 2,
      },
      {headerName: &#x27;OOMP&#x27;, field: &#x27;oomp&#x27;, sortable: true, cellClass: &#x27;number-cell&#x27;,
        width:    155,
        minWidth: 155,
        maxWidth: 225,
        flex: 2,
      },
      {headerName: &#x27;oompb&#x27;, field: &#x27;oompb&#x27;, sortable: true,
        width:    155,
        minWidth: 155,
        maxWidth: 225,
        flex: 2,
      },
      {headerName: &#x27;Identification Method&#x27;, field: &#x27;value&#x27;, sortable: true,
        width:    155,
        minWidth: 155,
        maxWidth: 225,
        flex: 2,
      },
      {headerName: &#x27;Package Label&#x27;, field: &#x27;packageLabel&#x27;, sortable: true,
      width:    155,
      minWidth: 155,
      maxWidth: 225,
      flex: 2,
      },
      {headerName: &#x27;Quantity&#x27;, field: &#x27;quantityTotal&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;UOM&#x27;, field: &#x27;unitType&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;UTHC%&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;UTHCC&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,},
      {headerName: &#x27;UTHCUOM&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;Unit Weight&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;UWUOM&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;TotalAmount&#x27;, field: &#x27;netTotal&#x27;, sortable: true,
        width:    155,
        minWidth: 155,
        maxWidth: 225,
        flex: 2,
        cellRenderer: this.agGridService.currencyCellRendererUSD},
      {headerName: &#x27;Invoice#&#x27;, field: &#x27;orderID&#x27;, sortable: true,
        width:    155,
        minWidth: 155,
        maxWidth: 225,
        flex: 2,
      },
      {headerName: &#x27;Price&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;ExciseTax&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;CityTax&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;CountyTax&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;MunicipalTax&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;DiscountAmount&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;SubTotal&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,
      },
      {headerName: &#x27;SalesTax&#x27;, field: &#x27;value&#x27;, sortable: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,},

      {headerName: &#x27;History&#x27;, field: &#x27;history&#x27;, sortable: true,
        hide: true,
        width: 90,
        minWidth: 90,
        maxWidth: 90,},
    ]
  }

  initSearchModel() {
    let searchModel        &#x3D; {} as PointlessMetrcSearchModel;
    if (this.searchModel) {
      searchModel &#x3D; this.searchModel
    }
    searchModel.pageSize   &#x3D; this.pageSize
    searchModel.pageNumber &#x3D; this.currentPage;
    this.pointlessMetrcSalesReport.updateSearchModel(searchModel)
    return searchModel
  }

  refreshSearch(): Observable&lt;PointlessMetrcSearchModel&gt; {
    return this.refreshSearch_sub();
  }

  refreshSearchByZRUN(event) {
    if (!event) {  return;  }
    this.exceptions &#x3D; []
    this.searchModel.zRUN &#x3D; event.zrun;
    this.refreshSearch();
  }

  refreshSearchAny(event) {
    if (!event) {  return;  }
    this.exceptions &#x3D; []
    this.currentPage &#x3D; 1;
    this.refreshSearch();
  }

  refreshSearch_sub(): Observable&lt;PointlessMetrcSearchModel&gt; {
    if (this.params){
      this.params.startRow     &#x3D; 1;
      this.params.endRow       &#x3D; this.pageSize;
    }
    this.onGridReady(this.params);
    return this._searchItems$;
  }

  //this doesn&#x27;t change the page, but updates the properties for getting data from the server.
  setCurrentPage(startRow: number, endRow: number): number {
    const tempStartRow &#x3D; this.startRow;
    this.startRow      &#x3D; startRow;
    this.endRow        &#x3D; endRow;
    if (tempStartRow &gt; startRow) { return this.currentPage - 1 };
    if (tempStartRow &lt; startRow) { return this.currentPage + 1 };
    return this.currentPage;
  }

  getRowData(params, startRow: number, endRow: number):  Observable&lt;METRCSalesReportPaged&gt;  {
    const site                &#x3D; this.siteService.getAssignedSite()
    if (this.searchModel &amp;&amp; this.searchModel.currentDay) {
      if (this.currentDayRan) {
        this.processing &#x3D; false
        return of(null)
      }
      this.setCurrentPage(1, 100000)
      this.currentPage   &#x3D; 1;
      this.currentDayRan &#x3D; true;
      return this.pointlessMetrcSalesReport.getUnclosedSalesReport(site, this.searchModel)
    }
    this.currentPage            &#x3D; this.setCurrentPage(startRow, endRow)
    if (!this.searchModel) { this.searchModel &#x3D; {}  as PointlessMetrcSearchModel};
    this.searchModel.pageSize   &#x3D; this.pageSize
    this.searchModel.pageNumber &#x3D; this.currentPage;
    return this.pointlessMetrcSalesReport.getSalesReport(site, this.searchModel)
  }

  setPaging(resp: IPagedList) {
    this.isfirstpage   &#x3D; resp.isFirstPage
    this.islastpage    &#x3D; resp.isFirstPage
    this.currentPage   &#x3D; resp.currentPage
    this.numberOfPages &#x3D; resp.pageCount
    this.recordCount   &#x3D; resp.recordCount
    this.totalRecordCount &#x3D; resp.totalRecordCount;
  }

  //ag-grid standard method
  onGridReady(params: any) {
    if (params)  {
      this.params  &#x3D; params
      this.gridApi &#x3D; params.api;
      params.api.sizeColumnsToFit();
      this.autoSizeAll(false);
    }
    this.onFirstDataRendered(this.params)

    if (params &#x3D;&#x3D; undefined) {
      return;
    }

    if (!params.startRow ||  !params.endRow) {
      params.startRow &#x3D; 1;
      params.endRow &#x3D; this.pageSize;
    }

    this.processing &#x3D; true;

    if (this.searchModel.currentDay) {
      this.pageSize &#x3D; 100000;
      this.initColumnDefs(1000000);
      this.gridOptions &#x3D; this.agGridFormatingService.initGridOptionsClientType(this.recordCount , this.columnDefs);
      this.getRowData(params, params.startRow, params.endRow).subscribe(data &#x3D;&gt; {
        if (!data)  {
          this.rowData &#x3D; null;
          return;}
        if (this.getException(data))  {
          this.rowData &#x3D; null;
          return;
        }
        this.processing &#x3D; false;
        this.rowData    &#x3D; data.results;
        this.getExceptions(data?.exceptions);
        this.setPaging(data.paging);
      })
      return;
    }

    let datasource &#x3D;  {
      getRows: (params: IGetRowsParams) &#x3D;&gt; {
      const items$    &#x3D; this.getRowData(params, params.startRow, params.endRow)
      items$.subscribe(data &#x3D;&gt;
        {
            if (!data)  {return;}
            if (this.getException(data))  {return;}
            const resp      &#x3D;  data.paging;
            this.processing &#x3D; true;
            this.getExceptions(data?.exceptions);
            this.updateResize();

            if (resp) {
              this.setPaging(data.paging)
              if (this.numberOfPages !&#x3D;0 &amp;&amp; this.numberOfPages) {
                this.value &#x3D; ((this.currentPage / this.numberOfPages ) * 100).toFixed(0)
              }
            }

            if (data.results) {
              let results  &#x3D;  this.refreshImages(data.results)
              params.successCallback(results)
              this.rowData &#x3D; results
            }
            this.processing &#x3D; false;
          }
        );
      }
    };

    if (!datasource)   { return }
    if (!this.gridApi) { return }
    this.gridApi.setDatasource(datasource);
    this.autoSizeAll(true);
  }

  getException(data: any) {
    if (!data || data?.exceptionMessage) {
      this.exceptionMessage &#x3D; data?.exceptionMessage;
      this.processing &#x3D; false
      return true
    }
    return false;
  }

  getExceptions(exceptions: any[]) {
    if (!this.exceptions) { this.exceptions &#x3D; []}
    if (exceptions)  {
      this.exceptions &#x3D; [ ...this.exceptions, ...exceptions];
      this.exceptions &#x3D; [ ... this.exceptions];
    }
  }

  onFirstDataRendered (params) {
    try {
      if (!params || params.api) {return}
      params.api.sizeColumnsToFit()
    } catch (error) {
      console.log(error)
    }
  }

  onSelectionChanged(event) {
    if (!event) { return }
  }

  editProductFromGrid(e) {
    let history &#x3D; false
    // const historyValue &#x3D;

    if ( +e.rowData?.history &#x3D;&#x3D; 1) {
      history &#x3D; true;
    }
    if (! e.rowData?.history || +e.rowData?.history &#x3D;&#x3D; 0) {
      history &#x3D; false;
    }

    this.setActiveOrder({id: e.rowData.orderID, history: history})
  }


  setActiveOrderByException(orderID: number,history: any) {
    if (+history &#x3D;&#x3D; 1) {
      history &#x3D; true;
    }
    if (!history || +history &#x3D;&#x3D; 0) {
      history &#x3D; false;
    }
    this.setActiveOrder({id: orderID, history: history})
  }

  setActiveOrder(event) {
    const site  &#x3D; this.siteService.getAssignedSite();
    let history &#x3D; false

    if (!event.history) {
      history &#x3D; false
    }
    if (+event.history &#x3D;&#x3D; 1) {
      history &#x3D; true
    }
    if (+event.history &#x3D;&#x3D; 0) {
      history &#x3D; false
    }

    const order$ &#x3D; this.orderService.getOrder(site, event.id, history )
    this.order$  &#x3D; order$.pipe(
      switchMap(data &#x3D;&gt;
      {
        this.orderMethodsService.setActiveOrder(site, data)
        return of(data)
      }
    ))
  }

  refreshImages(data) {
      const urlPath &#x3D; this.urlPath
      if (urlPath) {
        data.forEach( item &#x3D;&gt;
          {
            if (item.urlImageMain) {
              const list &#x3D; item.urlImageMain.split(&#x27;,&#x27;)
              if (list[0]) {
                item.imageName &#x3D; &#x60;${urlPath}${list[0]}&#x60;
              }
            }
          }
        )
      }
    return data;
  }

  //search method for debounce on form fieldf
  displayFn(search) {
    this.selectItem(search)
    return search;
  }

//search method for debounce on form field
  selectItem(search){
    if (search) {
      this.currentPage &#x3D; 1
      this.searchPhrase.next(search)
    }
  }

    autoSizeAll(skipHeader) {
      if (! this.gridOptions ) { return }
      if (!this.gridOptions || !this.gridOptions.columnApi) {return}
      try {
        var allColumnIds &#x3D; [];
        this.gridOptions.columnApi.getAllColumns().forEach(function (column) {
          allColumnIds.push(column.colId);
        });
        this.gridOptions.columnApi.autoSizeColumns(allColumnIds, skipHeader);
      } catch (error) {
        console.log(error)
      }
    }

    getLabel(rowData)
    {
      if(rowData) {
        if (!rowData.orderID) {return &#x27;Unknown&#x27;}
        const value &#x3D; rowData.orderID.toString().substr(-5);
        return value
      } else {
          return &#x27;Unknown&#x27;
      }
    }

    onExportToCsv() {
      if (this.searchModel.currentDay) {
        this.exportDailySales()
        return;
      }
      if (!this.searchModel.currentDay) {
        const fields &#x3D; [&#x27;completeDate&#x27;,&#x27;clientType&#x27;, &#x27;oomp&#x27;,  &#x27;oompb&#x27;, &#x27;value&#x27;, &#x27;packageLabel&#x27;,&#x27;quantityTotal&#x27;,&#x27;unitType&#x27;,&#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, &#x27;netTotal&#x27;,&#x27;orderID&#x27;,
                        , &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27;, , &#x27;value&#x27;, &#x27;value&#x27; , &#x27;value&#x27;, &#x27;value&#x27;, &#x27;value&#x27; ]

        const options &#x3D; {} as UnparseConfig;
        options.quotes &#x3D; false;
        options.header &#x3D; false;
        options.skipEmptyLines &#x3D; true;
        this.gridApi.exportDataAsCsv({ columnKeys: fields, allColumns: false,
                                        fileName: &#x27;metrc&#x27; + this.dateFrom, skipColumnHeaders: true, suppressQuotes: true});
        return;
      }
    }

    capitalizeFirstLetter(string) {
      return string.charAt(0).toUpperCase() + string.slice(1);
    }

    exportDailySales() {
      const list &#x3D; [] as  metrcSalesReport[];
      this.rowData.forEach(data &#x3D;&gt; {

        let item &#x3D; {} as metrcSalesReport;
        if (!data.quantityTotal) {
          console.log(&#x27;no  quantityTotal&#x27;, data )
        }

        const clientType &#x3D; data?.clientType.toString() as string;
        if (clientType.toLowerCase() &#x3D;&#x3D;&#x3D; &#x27;caregiver&#x27;) {
        }

        const dateFormat &#x3D; data?.completeDate.slice(0, 10);
        const mediumTime &#x3D;  this.datePipe.transform( data?.completeDate, &#x27;mediumTime&#x27;);
        item.completeDate &#x3D; &#x60;${dateFormat} ${mediumTime}&#x60;;
        item.clientType&#x3D;  this.capitalizeFirstLetter(clientType);
        item.oomp&#x3D; data?.oomp;
        item.oompb&#x3D; data?.oompb;
        item.idMethod &#x3D; &#x27;&#x27;;
        item.packageLabel &#x3D; data?.packageLabel;

        item.quantityTotal &#x3D; &#x27;0&#x27;
        if ( data?.quantityTotal) {
          item.quantityTotal&#x3D; data?.quantityTotal.toFixed(2);
        }
        item.uom &#x3D; data?.unitType;
        item.UTHC &#x3D; &#x27;&#x27;;
        item.UTHCC &#x3D; &#x27;&#x27;;
        item.UTHCUOM &#x3D; &#x27;&#x27;;
        item.UnitWeight &#x3D; &#x27;&#x27;;
        item.UWUOM &#x3D; &#x27;&#x27;;

        item.netTotal &#x3D; &#x27;0&#x27;;
        if (data.netTotal) {
          item.netTotal &#x3D; data?.netTotal.toFixed(2);
        }
        if (!data.netTotal) {
          console.log(&#x27;no net total&#x27;, data.id )
        }

        item.orderID  &#x3D; data?.orderID;
        item.Price&#x3D; &#x27;0&#x27;;
        item.ExciseTax &#x3D; &#x27;0&#x27;;
        item.CityTax &#x3D; &#x27;0&#x27;;
        item.CountyTax &#x3D; &#x27;0&#x27;;
        item.MunicipalTax &#x3D; &#x27;0&#x27;;
        item.DiscountAmount &#x3D; &#x27;0&#x27;;
        item.SubTotal &#x3D; &#x27;0&#x27;;
        item.SalesTax &#x3D; &#x27;0&#x27;;
        list.push(item)
      })
      // const data &#x3D; JSON.stringify(list)
      const options &#x3D; {} as UnparseConfig;
      options.quotes &#x3D; false;
      options.header &#x3D; false;
      options.skipEmptyLines &#x3D; true;
      const date  &#x3D; new Date()
      const dateString &#x3D; this.dateHelperService.format(date.toString(), &quot;MM/dd/yyyy&quot;);
      this.reportingItemsSalesService.downloadPapa(list, &#x60;METRCSalesReport ${dateString}&#x60; , options)
    }

    setSite(id: any) {
      this.site$ &#x3D; this.siteService.getSite(id).pipe(
        switchMap(data &#x3D;&gt; {
          this.site &#x3D; data
          this.siteService.setAssignedSite(this.site);
          return of(data)
        })
      )
    }

}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'metrcSalesReport.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
