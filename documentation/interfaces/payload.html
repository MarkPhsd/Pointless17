<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>pointless documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top d-block d-sm-none">
            <a href="../" class="navbar-brand">pointless documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">













<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  payload</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/modules/posorders/pos-order-item/pos-order-item.component.ts</code>
        </p>




        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#index" 
>
                                            index
                                        </a>
                                </li>
                                <li>
                                        <a href="#item" 
>
                                            item
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="index"></a>
                                        <span class="name "><b>index</b>
                                            <a href="#index">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>index:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="item"></a>
                                        <span class="name "><b>item</b>
                                            <a href="#item">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>item:         <code><a href="../interfaces/PosOrderItem.html" target="_self" >PosOrderItem</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="../interfaces/PosOrderItem.html" target="_self" >PosOrderItem</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { AfterViewInit, Component, ElementRef,  HostListener,
         Input, OnInit, Output, EventEmitter, OnDestroy, ViewChild, TemplateRef } from &#x27;@angular/core&#x27;;
import { UntypedFormBuilder, UntypedFormGroup, Validators } from &#x27;@angular/forms&#x27;;
import { ThemePalette } from &#x27;@angular/material/core&#x27;;
import { MatDialog } from &#x27;@angular/material/dialog&#x27;;
import { ProgressSpinnerMode } from &#x27;@angular/material/progress-spinner&#x27;;
import { MatSnackBar } from &#x27;@angular/material/snack-bar&#x27;;
import { DomSanitizer } from &#x27;@angular/platform-browser&#x27;;
import { ActivatedRoute, Router } from &#x27;@angular/router&#x27;;
import { Observable, of, Subscription, switchMap } from &#x27;rxjs&#x27;;
import { IPurchaseOrderItem } from &#x27;src/app/_interfaces&#x27;;
import { IMenuItem } from &#x27;src/app/_interfaces/menu/menu-products&#x27;;
import { IPromptGroup } from &#x27;src/app/_interfaces/menu/prompt-groups&#x27;;
import { IPOSOrder, PosOrderItem } from &#x27;src/app/_interfaces/transactions/posorder&#x27;;
import { TruncateTextPipe } from &#x27;src/app/_pipes/truncate-text.pipe&#x27;;
import { AWSBucketService, MenuService, OrdersService } from &#x27;src/app/_services&#x27;;
import { InventoryAssignmentService } from &#x27;src/app/_services/inventory/inventory-assignment.service&#x27;;
import { PromptGroupService } from &#x27;src/app/_services/menuPrompt/prompt-group.service&#x27;;
import { SitesService } from &#x27;src/app/_services/reporting/sites.service&#x27;;
import { PrintingService } from &#x27;src/app/_services/system/printing.service&#x27;;
import { TransactionUISettings } from &#x27;src/app/_services/system/settings/uisettings.service&#x27;;
import { UserAuthorizationService } from &#x27;src/app/_services/system/user-authorization.service&#x27;;
import { OrderMethodsService } from &#x27;src/app/_services/transactions/order-methods.service&#x27;;
import { POSOrderItemService } from &#x27;src/app/_services/transactions/posorder-item-service.service&#x27;;
import { MenuItemModalComponent } from &#x27;../../menu/menuitems/menu-item-card/menu-item-modal/menu-item-modal.component&#x27;;
import { PosOrderItemEditComponent } from &#x27;./pos-order-item-edit/pos-order-item-edit.component&#x27;;
import { IUserAuth_Properties } from &#x27;src/app/_services/people/client-type.service&#x27;;
export interface payload{
  index : number;
  item  : PosOrderItem;
}
@Component({
  selector: &#x27;pos-order-item&#x27;,
  templateUrl: &#x27;./pos-order-item.component.html&#x27;,
  styleUrls: [&#x27;./pos-order-item.component.scss&#x27;],
  providers: [ TruncateTextPipe ],
})
export class PosOrderItemComponent implements OnInit, AfterViewInit,OnDestroy {

  inputForm: UntypedFormGroup;
  itemEdit: boolean;
  interface &#x3D; {}
  payload: payload;

  @ViewChild(&#x27;imageDisplay&#x27;) imageDisplay: TemplateRef&lt;any&gt;;
  @Output() outputDelete   :  EventEmitter&lt;any&gt; &#x3D; new EventEmitter();
  @Output() outputSelectedItem : EventEmitter&lt;any&gt; &#x3D; new EventEmitter();
  @Input() uiConfig : TransactionUISettings;

  @Input() purchaseOrderEnabled : boolean;
  @Input() index          &#x3D; 0;
  @Input() orderItem      : PosOrderItem;
  @Input() order          : IPOSOrder;
  @Input() menuItem       : IMenuItem;
  @Input() mainImage      : string;
  @Input() placeHolderImage &#x3D; &#x27;productPlaceHolder.jpg&#x27;;
  @Input() quantity       : number;
  @Input() unitPrice      : number;
  @Input() wholeSale      : number;
  @Input() subTotal       : number;
  @Input() total          : number;
  @Input() printed        : string;
  @Input() onlineShortDescription: string;
  @Input() id             : number;
  @Input() productID      : number;
  @Input() productName    : string;
  @Input() thc            &#x3D;  50;
  @Input() cbd            &#x3D;  50;
  @Input() hideAddAnotherOne: number;
  @Input() mainPanel      : boolean;
  @Input() wideBar        &#x3D; false;
  @Input() disableActions &#x3D; false;
  @Input() prepScreen     : string;
  @Input() enableExitLabel : boolean;

  morebutton               &#x3D; &#x27;more-button&#x27;;
  customcard               &#x3D;&#x27;custom-card&#x27;
  orderPromptGroup        : IPromptGroup;
  menuItem$               : Observable&lt;IMenuItem&gt;;
  printLabel$             : Observable&lt;any&gt;;
  isNotInSidePanel        : boolean
  sidePanelWidth          : number
  sidePanelPercentAdjust  : number

  @Input() printLocation : number;
  @Input() prepStatus    : boolean;

  animationState          : string;
  color                   : ThemePalette &#x3D; &#x27;primary&#x27;;
  mode                    : ProgressSpinnerMode &#x3D; &#x27;determinate&#x27;;
  value                   &#x3D; 50;
  bucketName:             string;
  awsBucketURL:           string;
  itemName   :            string;
  imagePath   :           string;

  smallDevice           : boolean;

  showEdit              : boolean;
  showView              : boolean;
  promptOption          : boolean;
  @Input() userAuths       :   IUserAuth_Properties;

  bottomSheetOpen       : boolean ;
  _bottomSheetOpen      : Subscription;

  assignedPOSItems      : PosOrderItem[];
  _assignedPOSItems      : Subscription;

  basicItem$: Observable&lt;any&gt;;
  gridItems             &#x3D; &#x27;grid-items&#x27;
  // transactionUISettings$ &#x3D; this.uiSettingService.getSetting(&#x27;UITransactionSetting&#x27;);
  productnameClass       &#x3D; &#x27;product-name&#x27;
  isModifier            : boolean;
  isItemKitItem         : boolean;

  action$: Observable&lt;any&gt;;

  panel  &#x3D;&#x27;string&#x27;
  @HostListener(&quot;window:resize&quot;, [])
   updateItemsPerPage() {
     this.smallDevice &#x3D; false
     if (window.innerWidth &lt; 768) {
       this.smallDevice &#x3D; true
     }
  }

  get itemHasDiscount() {
    const item &#x3D; this.orderItem
    if (item.itemOrderCashDiscount !&#x3D; 0 || item.itemPercentageDiscountValue !&#x3D; 0 || item.itemPercentageDiscountValue !&#x3D; 0 ||
        item.itemOrderPercentageDiscount ) {
          return true;
    }
    return false;

  }

  //&amp;&amp;
  // (!this.orderItem.rewardAvailibleID || this.orderItem.rewardCounterDiscountID &#x3D;&#x3D;0)
  get showQuantityEdit() {
    if ((!this.showEdit  &amp;&amp; (this.uiConfig.displayQuantity) &amp;&amp;
       !this.orderItem.serialCode &amp;&amp; !this.orderItem.printed ) &amp;&amp;
       this.orderItem.rewardGroupApplied &#x3D;&#x3D; 0) {
      return true;
    }
    return false;

  }

  refundItem() {
    // this.orderItem.discountScheduleID
  }

  initSubscriptions() {
    this.initAssignedItemSubscriber();
    this.initBottomSheetSubscriber();
  }

  initBottomSheetSubscriber() {
    this._bottomSheetOpen &#x3D; this.orderMethodsService.bottomSheetOpen$.subscribe(data &#x3D;&gt; {
      this.bottomSheetOpen &#x3D; data
      this.morebutton &#x3D; &#x27;more-button&#x27;
      if (data) {
        this.mainPanel &#x3D; data;
        this.morebutton &#x3D; &#x27;more-button-main&#x27;
        this.isNotInSidePanel &#x3D; data;
        this.updateCardStyle(data)
      }
    })
  }


  initAssignedItemSubscriber() {
    //disabled  class style when added button for item functions
    this._assignedPOSItems &#x3D; this.orderMethodsService.assignedPOSItems$.subscribe( data &#x3D;&gt; {
        this.assignedPOSItems &#x3D; data;
        if ( this.orderMethodsService.isItemAssigned( this.orderItem.id ) ) {
          this.productnameClass &#x3D; &#x27;product-name-alt&#x27;
          return
        } else {
          this.productnameClass &#x3D; &#x27;product-name&#x27;
          return
        }
      }
    )
  }

  ngOnDestroy(): void {
    //Called once, before the instance is destroyed.
    //Add &#x27;implements OnDestroy&#x27; to the class.
    this.assignedPOSItems &#x3D; null;
    this.orderMethodsService.clearAssignedItems();
    if (this._bottomSheetOpen) { this._bottomSheetOpen.unsubscribe()}
    if (this._assignedPOSItems) { this._assignedPOSItems.unsubscribe()}
  }

  constructor(  private orderService: OrdersService,
                private orderMethodsService: OrderMethodsService,
                private awsBucket          : AWSBucketService,
                private _snackBar          : MatSnackBar,
                private sanitizer          : DomSanitizer,
                public  el:                 ElementRef,
                private router:             Router,
                public  route:              ActivatedRoute,
                private truncateTextPipe   : TruncateTextPipe,
                private siteService        : SitesService,
                private dialog             : MatDialog,
                private menuService        : MenuService,
                private posOrderItemService: POSOrderItemService,
                private inventoryService   : InventoryAssignmentService,
                private promptGroupservice : PromptGroupService,
                private printingService    : PrintingService,
                public  userAuthService    : UserAuthorizationService,

                private fb: UntypedFormBuilder,
              )
  {
  }

  async ngOnInit() {

    this.initSubscriptions();

    const site &#x3D; this.siteService.getAssignedSite();
    this.bucketName   &#x3D;  await this.awsBucket.awsBucket();
    this.awsBucketURL &#x3D;  await this.awsBucket.awsBucketURL();
    // this.orderItem.printLocation
    if (this.orderItem) {
      this.menuItem$  &#x3D; this.menuService.getMenuItemByID(site, this.orderItem.productID)
    }

    if (this.menuItem) {
      this.itemName   &#x3D;  this.getItemName(this.menuItem.name)
      this.imagePath  &#x3D;  this.getItemSrc(this.menuItem)
    }

    if (!this.menuItem) {
      this.basicItem$ &#x3D; this.menuService.getItemBasicImage(site, this.orderItem?.productID).pipe(
        switchMap( data &#x3D;&gt; {
          this.imagePath  &#x3D;  this.getItemSrcBasic(data?.image)
          return of(data)
        })
      )
    }

    if (this.orderItem &amp;&amp; this.orderItem.id !&#x3D; this.orderItem.idRef )  {

    }

    const item &#x3D; this.orderItem;
    this.showEdit &#x3D; !item.printed &amp;&amp; (this.quantity &amp;&amp; !item.voidReason) &amp;&amp;  item.promptGroupID !&#x3D; 0 &amp;&amp; item.id !&#x3D; item.idRef
    this.showView &#x3D; this.mainPanel &amp;&amp; ( (  item.promptGroupID &#x3D;&#x3D;&#x3D; 0) || ( item.promptGroupID !&#x3D; 0 &amp;&amp; item.id !&#x3D; item.idRef ) )
    this.promptOption &#x3D; (item.promptGroupID !&#x3D; undefined &amp;&amp; item.promptGroupID !&#x3D; 0)

    if (this.mainPanel) {
      this.morebutton &#x3D; &#x27;more-button-main&#x27;;
    }
    if (!this.mainPanel) {
      this.morebutton &#x3D; &#x27;more-button&#x27;;
    }
    this.updateCardStyle(this.mainPanel)
    this.refreshSidePanel()
    // this.orderItem.
  }

  initEdit() {
    if (this.purchaseOrderEnabled &amp;&amp; !this.itemEdit) {
      this.itemEdit &#x3D; true;
      try {
        this.inputForm &#x3D; this.fb.group( this.orderItem )
        this.inputForm.patchValue(this.orderItem)
        this.inputForm.valueChanges.subscribe(item &#x3D;&gt; {
          this.action$ &#x3D; this.updateValues(item)
        })
      } catch (error) {
        console.log(error)
      }
    }
  }

  displayPrintLabel(item) {
    // console.log(&#x27;displayPrintLabel&#x27;, item) //item?.itemType?.name, item?.itemType?.labelTypeID )//labelID)
    // if (this.ui)
    // console.log(&#x27;item type&#x27; , item?.itemType)
    const labelID &#x3D;  item?.itemType?.labelTypeID
    if (labelID &amp;&amp; labelID !&#x3D; 0) {
      return true
    }
  }

  destroyEdit() {
    // if (this.lockEdit) { return }
    if ( this.orderMethodsService.isItemAssigned( this.orderItem.id ) ) { return }
    this.itemEdit &#x3D; false;
    this.inputForm &#x3D; null;
  }

  updateValues(item: PosOrderItem) {
    const site &#x3D; this.siteService.getAssignedSite();
    return this.posOrderItemService.changeItemValues(site, item ).pipe(
      switchMap(data &#x3D;&gt; {
        if (data) {
          this.orderMethodsService.updateOrderSubscription(data)
          return of(data)
        }
        return of(null)
      })
    )
 }

  get isDisplayMenuItemOn() {
    if (this.mainPanel) {
      return this.imageDisplay
    }
    return null;
  }

  ngAfterViewInit() {
    this.resizeCheck();
  }

  assignItem() {
    const result &#x3D; this.orderMethodsService.updateAssignedItems(this.orderItem);
    if (result) {
      this.initEdit()
    }
    if (!result) {
      this.destroyEdit()
    }
  }

  preventUnAssigned() {
    this.orderMethodsService.updateAssignedItems(this.orderItem)
  }

  @HostListener(&#x27;window:resize&#x27;, [&#x27;$event.target&#x27;]) onResize()
  {
    this.resizeCheck();
  }

  private resizeCheck(): void {
    this.sidePanelWidth &#x3D; this.el.nativeElement.offsetWidth;
    if (this.sidePanelWidth &#x3D;&#x3D; 0) {
      this.sidePanelWidth &#x3D; this.el.nativeElement.scrollWdith;
    }
    this.refreshSidePanel();
  }

  openModifierNote() {
    this.editProperties(&#x27;modifierNote&#x27;, &#x27;Special Instructions&#x27;)
  }

  editQuantity() {
    this.editProperties(&#x27;quantity&#x27; , &#x27;Change Quantity&#x27;)
  }

  editPrice() {
    this.editProperties(&#x27;price&#x27; , &#x27;Change Price&#x27;)
  }

  editSubTotal() {
    this.editProperties(&#x27;subTotal&#x27; , &#x27;Change Sub Total Price&#x27;)
  }

  editCost() {
    this.editProperties(&#x27;wholeSale&#x27; , &#x27;Change Cost&#x27;)
  }

  editWholeSaleCost() {
    this.editProperties(&#x27;wholeSaleCost&#x27; , &#x27;Change Total Cost&#x27;)
  }

  selectItem() {
    if (this.productnameClass !&#x3D; &#x27;product-name-alt&#x27;) {
      this.productnameClass &#x3D;&#x3D; &#x27;product-name-alt&#x27;
    }
    if (this.productnameClass !&#x3D; &#x27;product-name&#x27;) {
      this.productnameClass &#x3D;&#x3D; &#x27;product-name-alt&#x27;
    }
  }

  selectAssignedItem(isAssigned: boolean) {
    if (isAssigned) {
      this.productnameClass &#x3D;&#x3D; &#x27;product-name-alt&#x27;
    }
    if (!isAssigned) {
      this.productnameClass &#x3D;&#x3D; &#x27;product-name-alt&#x27;
    }
    // console.log(this.productnameClass )
  }

  editProperties(editField: string, instructions: string) {
    let dialogRef: any;
    if (!this.orderItem) {return}
    const site &#x3D; this.siteService.getAssignedSite();
    this.menuService.getMenuItemByID(site, this.orderItem.productID).subscribe(data &#x3D;&gt; {
        this.menuItem &#x3D; data;
        if (!this.menuItem.itemType) {
          this.notifyEvent(&#x27;Item type not defined&#x27;, &#x27;Alert&#x27;)
          return;
        }
        let requireWholeNumber &#x3D; false;
        if (editField &#x3D;&#x3D; &#x27;quantity&#x27;) {
          requireWholeNumber &#x3D; this.menuItem.itemType.requireWholeNumber
        }
        const item &#x3D; {orderItem: this.orderItem,
                      editField: editField,
                      menuItem: this.menuItem,
                      requireWholeNumber: requireWholeNumber,
                      instructions: instructions}
        let height  &#x3D; &#x27;600px&#x27;;
        let width   &#x3D; &#x27;455px&#x27;
        if (editField &#x3D;&#x3D; &#x27;quantity&#x27;) {
          height  &#x3D; &#x27;600px&#x27;;
          width   &#x3D; &#x27;455px&#x27;
        }

        if (editField &#x3D;&#x3D; &#x27;modifierNote&#x27;) {
          height  &#x3D; &#x27;100vh&#x27;;
          width   &#x3D; &#x27;100vw&#x27;
        }

        dialogRef &#x3D; this.dialog.open(PosOrderItemEditComponent,
          { width     : width,
            minWidth  : &#x27;300px&#x27;,
            height    : height,
            minHeight : height,
            data      : item
          },
        )
        dialogRef.afterClosed().subscribe(result &#x3D;&gt; {
        // this.refreshData();
        // update order
        });
    })
  }

  editSerial() {
    if (this.orderItem) {
      const site &#x3D; this.siteService.getAssignedSite();
      const item$ &#x3D; this.posOrderItemService.getPOSOrderItem(site, this.orderItem.id)
      item$.subscribe(
        {
          next: data &#x3D;&gt; {
          this.orderMethodsService.promptSerial(this.menuItem, data.id, true, data.serialCode)
            },
          error: err &#x3D;&gt; {
            console.log(&#x27;error&#x27;, err)
          }
        }
      )
    }
  }

  refreshSidePanel() {
    this.gridItems &#x3D; &#x27;grid-items&#x27;;
    this.morebutton &#x3D; &#x27;more-button&#x27;
    if (this.mainPanel) {
      this.gridItems &#x3D;&#x27;grid-items-main-panel&#x27;
      this.morebutton &#x3D; &#x27;more-button-main&#x27;
    }

    if (this.sidePanelWidth &#x3D;&#x3D; undefined) { return }
      if (this.sidePanelWidth &lt; 200 || this.mainPanel ) {
        this.isNotInSidePanel &#x3D; false
        this.sidePanelPercentAdjust &#x3D; 80
      } else {
        this.isNotInSidePanel &#x3D; true
        this.sidePanelPercentAdjust &#x3D; 80
        this.updateCardStyle(true)
      }

      if (this.onlineShortDescription) {
      this.onlineShortDescription &#x3D;  this.truncateTextPipe.transform(this.onlineShortDescription.replace(/&lt;[^&gt;]+&gt;/g, &#x27;&#x27;), 200)
    }

  }

  listItem() {
    if (this.menuItem) {
      this.router.navigate([&quot;/menuitem/&quot;, {id: this.productID}]);
      return
    } else {
      if (this.productID){
        this.router.navigate([&quot;/menuitem/&quot;, {id: this.productID}]);
        return
      }
    }

    if (this.orderItem) {
      this.router.navigate([&quot;/menuitem/&quot;, {id: this.orderItem.productID}]);
    }
  }

  cancelItem(index: number, orderItem: PosOrderItem) {
    // console.log(&#x27;cancel item&#x27;)
    let payload &#x3D; {} as payload
    payload.index &#x3D; index;
    payload.item  &#x3D; orderItem;
    this.outputDelete.emit(payload)
    // console.log(&#x27;remove item should clear last item added&#x27;)
    this.orderMethodsService.updateLastItemAdded(null)
  }

  async addItemToOrder() {
    if (!this.menuItem) {
      this.notifyEvent(&#x60;Feature not yet implemented.&#x60;, &#x27;alert&#x27;)
      return
    }
    this.notifyEvent(&#x60;item ${this.menuItem.name}&#x60;, &#x27;alert&#x27;)

    if (this.menuItem) {
      const quantity  &#x3D;  Number(1)
      this.orderMethodsService.addItemToOrder(this.order, this.menuItem, quantity)
    }
  }

  updateItemQuantity( quantity: number) {
    if (!this.printed){
      if (this.orderItem) {
        const site &#x3D; this.siteService.getAssignedSite()
        if (!this.orderItem ) {
          this.notifyEvent(&#x60;Order Item not found so not changed.&#x60; , &#x27;Thank You&#x27;)
           return
        }

        if (!this.menuItem) {
          this.notifyEvent(&#x60;Menu Item not found so not changed.&#x60; , &#x27;Thank You&#x27;)
           return
        }

        let item$ &#x3D; this.posOrderItemService.changeItemQuantity(site, this.orderItem)
        item$.subscribe(data &#x3D;&gt; {
          if (!data.resultMessage) {
            this.notifyEvent(&#x60;The quantity has not been changed. Is the item n inventory item? If so another item must be added on the order.&#x60; , &#x27;Thank You&#x27;)
          }
         }
        )
      }
    }
  }

  removeDiscount() {
    if (this.orderItem &amp;&amp; this.menuItem) {
      const site &#x3D; this.siteService.getAssignedSite();
      let item$ &#x3D; this.posOrderItemService.removeItemDiscount(site, this.orderItem, this.menuItem);
      item$.subscribe(data &#x3D;&gt; {
        this.orderMethodsService.updateOrderSubscription(data);
      })
    }
  }

  updateCardStyle(option: boolean)  {
    if (this.orderItem &amp;&amp; this.orderItem.idRef &amp;&amp; this.orderItem.id !&#x3D; this.orderItem.idRef) {
      this.customcard       &#x3D; &#x27;custom-card-modifier&#x27;;
      this.productnameClass &#x3D; &#x27;productname-modifier&#x27;
      this.isModifier       &#x3D; true;
      return
    }

    this.customcard &#x3D;&#x27;custom-card&#x27;;

    if (!option) {
      this.customcard &#x3D;&#x27;custom-card-side&#x27;;
    }
  }

  openDialog() {
    const item &#x3D; this.orderItem
    const data &#x3D; { id: item.productID }
    const dialogRef &#x3D; this.dialog.open(MenuItemModalComponent,
      { width: &#x27;90vw&#x27;,
        height: &#x27;90vh&#x27;,
        data :  data ,
      },
    )
  }

  increaseByOne(){
    this.changeQuantity(1);
  }

  decreaseByOne() {
    this.changeQuantity(-1)
  }

  changeQuantity(changeValue: number) {
    this.quantity &#x3D; this.quantity + changeValue;
  }

  sanitize(html) {
    return this.sanitizer.bypassSecurityTrustHtml(html);
  }

  getItemName(itemName) {
    return this.truncateTextPipe.transform(itemName.replace(/&lt;[^&gt;]+&gt;/g, &#x27;&#x27;), 20)
  }

  getItemSrc(item:IMenuItem) {
    if (!item?.urlImageMain) {
      return this.awsBucket.getImageURLPath(this.bucketName, &quot;placeholderproduct.png&quot;)
    } else {
      return this.awsBucket.getImageURLPath(this.bucketName, item.urlImageMain)
    }
  }

  getItemSrcBasic(image: string) {
    if (!image) {
      return this.awsBucket.getImageURLPath(this.bucketName, &quot;placeholderproduct.png&quot;)
    } else {
      return this.awsBucket.getImageURLPath(this.bucketName, image)
    }
  }

  getImageUrl(imageName: string): any {
    let imageUrl: string
    let ary: any[]
    if ( imageName ) {
      ary &#x3D; this.awsBucket.convertToArrayWithUrl( imageName, this.awsBucketURL )
      imageUrl &#x3D; ary[0]
    }
    return imageUrl
  }

  notifyEvent(message: string, action: string) {
    this._snackBar.open(message, action, {
      duration: 3000,
      verticalPosition: &#x27;bottom&#x27;
    });
  }

  printLabel(item: PosOrderItem) {
    this.printLabel$ &#x3D; this.printingService.printItemLabel(item, this.menuItem$,
                                                            this.order, false).pipe(switchMap(data &#x3D;&gt; { 
                                                              this.orderMethodsService.updateOrder(data)
                                                              return of(data)
                                                            })) // this.menuItem$)
  }

  swipeOutItem(){
    // console.log(&#x27;swipe out&#x27;)
    if (this.disableActions) {return}
    this.cancelItem(this.index,  this.orderItem)
  }

  editPrompt() {
    const site &#x3D; this.siteService.getAssignedSite();
    let item : IPurchaseOrderItem;
    if (this.orderItem) {
      const item$ &#x3D;  this.posOrderItemService.getPurchaseOrderItem(site, this.orderItem.id)
      item$.pipe(
        switchMap(poitem &#x3D;&gt; {
          item &#x3D; poitem;
          return this.promptGroupservice.getPrompt(site, item.promptGroupID)
        })).subscribe( prompt &#x3D;&gt;{
          this.orderMethodsService.openPromptWalkThroughWithItem(prompt, item)
      })
    }
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'payload.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
